// Assign Liquibase version
// def LIQUIBASE_VERSION = "4.8.0"

pipeline {
    agent any
    options {
        ansiColor('xterm')
    }

    stages {
        
        stage("Install IBM Cloud CLI and required Packages") {
            steps {

                // Installing IBM Cloud
                sh("curl -fsSL https://clis.cloud.ibm.com/install/linux | sh")

                // Verify the IBM Cloud CLI Version
                sh("ibmcloud --version")

                // Installing IBM Cloud container-service plugin
                sh("ibmcloud plugin install container-service -f -q")

                // Installing Python required packages
                sh('ls -lrt')
                sh('pwd')
                sh("pip install -r requirements.txt")
                
            }

        } //stage

        stage(""){
            environment{
                IBMCLOUD_CREDS = credentials('ibm-cloud-cr')
            }
            steps{
                sh("python get_the_vulnerabilities_images ${IBMCLOUD_CREDS}")
            }
        }

        
    } //stages
} //pipeline
